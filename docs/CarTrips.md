<link rel="shortcut icon" type="image/x-icon" href="https://www.tocc.tech/assets/img/favicon.ico">
<img src="https://www.tocc.tech/assets/img/logo/logo.svg" alt="drawing" style="width:200px;"/> 

# TOCC API Documentation
## Endpoints
### Get Trip Emissions
**Request Type:**
`POST` 

**Endpoint path**
```
https://api.eu.tocc.tech/EmissionCalculator/GetCarTripEmission
```

This method receives a trip information object in the request body and returns the total emissions generated by the indicated car in that trip

**Trip information:**
```json
{
  "distance": 0,
  "originLatitude": 0.0,
  "originLongitude": 0.0,
  "destinationLatitude": 0.0,
  "destinationLongitude": 0.0,
  "licensePlate": "string",
  "clientId": 0,
  "roundTrip": true
}
```

| Parameter  | Type | Value |
| ---------- | ------ | ------ |
| distance  | `Integer`  | Distance in meters. If distance is different than 0, then this value is used for the emission estimate and origin and destination Lat/Lon values are ignored |
| originLatitude  | `Double`  | Latitude of the car's starting point. (Ignored if `distance != 0`) |
| originLongitude  | `Double`  | Longitud of the car's starting point. (Ignored if `distance != 0`) |
| destinationLatitude  |  `Double`  | Latitude of the car's destination. (Ignored if `distance != 0`) |
| destinationLongitude  | `Double`  | Longitude of the car's destination. (Ignored if `distance != 0`) |
| licensePlate  | `String`  | License plate of the car used for the trip |
| clientId  | `String`  | Optional value used by the client |
| roundTrip  | `Boolean`  | if `true` trip emissions will be calculated as a roundtrip. :warning: This applies even if `distance != 0` |

**Response**
Each estimation request creates a unique identifier. This identifier must then be used to confirm the purchase of the corresponding certificates. 

```json
{
    "id": "00000000-0000-0000-0000-000000000000",
    "distanceInMeters": 0,
    "totalEmissions": 0.0,
    "totalCost": 0.0,
    "currency": ""
}
```

| Parameter  | Type | Value |
| ---------- | ------ | ------ |
| id  | `GUID`  | Latitude of the car's starting point |
| distanceInMeters  | `Integer`  | Total distance in meters for the trip |
| totalEmissions  |  `Double`  | Total emissions generated by the trip. Emissions are presented in kg of CO2e |
| totalCost  |  `Double`  | Total cost to mitigate the generated emissions |
| currency  | `String`  | ISO code for the currency |

**Sample Request**

```
curl -X 'POST' \
  'https://api.eu.tocc.tech/EmissionCalculator/GetCarTripEmission' \
  -H 'accept: text/plain' \
  -H 'Content-Type: application/json' \
  -d '{
  "originLatitude": 0,
  "originLongitude": 0,
  "destinationLatitude": 0,
  "destinationLongitude": 0,
  "licensePlate": "string",
  "clientId": 0,
  "roundTrip": true
}'
```
---
### Confirm Trip Mitigation Purchase
**Request Type:**
`POST` 

**Endpoint path**
```
https://api.eu.tocc.tech/EmissionCalculator/ConfirmMitigation/{ESTIMATION-ID}
```
Where `ESTIMATION-ID` is the `id` provided in the response of the trip estimation request.

**Optional data may be included in the request:**
```json
{
  "externalId": "abc123",
  "buyerEmail": "customer@email.com"
}
```

| Parameter  | Type | Value |
| ---------- | ------ | ------ |
| externalId  | `String`  | External Id used to identify the trip in client systems |
| buyerEmail  | `String`  | Certificate Buyer's Email. This is used to send the proof of purchase certificate to the buyer |

**Sample Request**
```
curl -X 'POST' \
  'https://localhost:7238/EmissionCalculator/ConfirmMitigation/00000000-0000-0000-0000-000000000000' \
  -H 'accept: */*' \
  -H 'Content-Type: application/json' \
  -d '{
  "externalId": "abc123",
  "buyerEmail": "customer@email.com"
}'
```
